"use strict";(self.webpackChunkworkflows_docs=self.webpackChunkworkflows_docs||[]).push([[330],{2250:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"workflows/license_check","title":"License Check","description":"At VGV, we keep track of the rights and restrictions external dependencies might impose on Dart or Flutter projects.","source":"@site/docs/workflows/license_check.md","sourceDirName":"workflows","slug":"/workflows/license_check","permalink":"/docs/workflows/license_check","draft":false,"unlisted":false,"editUrl":"https://github.com/VeryGoodOpenSource/very_good_workflows/tree/main/site/docs/workflows/license_check.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Flutter Pub Publish","permalink":"/docs/workflows/flutter_pub_publish"},"next":{"title":"Mason Publish","permalink":"/docs/workflows/mason_publish"}}');var r=s(4848),c=s(8453);const o={sidebar_position:5},l="License Check",t={},d=[{value:"Steps",id:"steps",level:2},{value:"Inputs",id:"inputs",level:2},{value:"<code>working_directory</code>",id:"working_directory",level:3},{value:"<code>runs_on</code>",id:"runs_on",level:3},{value:"<code>dart_sdk</code>",id:"dart_sdk",level:3},{value:"<code>allowed</code>",id:"allowed",level:3},{value:"<code>forbidden</code>",id:"forbidden",level:3},{value:"<code>skip_packages</code>",id:"skip_packages",level:3},{value:"<code>dependency_type</code>",id:"dependency_type",level:3},{value:"<code>ignore_retrieval_failures</code>",id:"ignore_retrieval_failures",level:3},{value:"Secrets",id:"secrets",level:2},{value:"<code>ssh_key</code>",id:"ssh_key",level:3},{value:"Example Usage",id:"example-usage",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"license-check",children:"License Check"})}),"\n",(0,r.jsx)(n.p,{children:"At VGV, we keep track of the rights and restrictions external dependencies might impose on Dart or Flutter projects."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["The License Check functionality is powered by ",(0,r.jsx)(n.a,{href:"https://cli.vgv.dev/docs/commands/check_licenses",children:"Very Good CLI's license checker"}),", for a deeper understanding of some ",(0,r.jsx)(n.a,{href:"#inputs",children:"inputs"})," refer to its ",(0,r.jsx)(n.a,{href:"https://cli.vgv.dev/docs/commands/check_licenses",children:"documentation"}),"."]})}),"\n",(0,r.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,r.jsx)(n.p,{children:"The License Check workflow consists of the following steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Setup Dart"}),"\n",(0,r.jsx)(n.li,{children:"Set SSH Key (if provided)"}),"\n",(0,r.jsx)(n.li,{children:"Install project dependencies"}),"\n",(0,r.jsx)(n.li,{children:"Check licenses"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"inputs",children:"Inputs"}),"\n",(0,r.jsx)(n.h3,{id:"working_directory",children:(0,r.jsx)(n.code,{children:"working_directory"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," The path to the root of the Dart or Flutter package."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'"."'})]}),"\n",(0,r.jsx)(n.h3,{id:"runs_on",children:(0,r.jsx)(n.code,{children:"runs_on"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," An optional operating system on which to run the workflow."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'"ubuntu-latest"'})]}),"\n",(0,r.jsx)(n.h3,{id:"dart_sdk",children:(0,r.jsx)(n.code,{children:"dart_sdk"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," Which Dart SDK version to use. It can be a version (e.g. ",(0,r.jsx)(n.code,{children:"3.5.0"}),") or a channel (e.g. ",(0,r.jsx)(n.code,{children:"stable"}),"):"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'"stable"'})]}),"\n",(0,r.jsx)(n.h3,{id:"allowed",children:(0,r.jsx)(n.code,{children:"allowed"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," Only allow the use of certain licenses. The expected format is a comma-separated list."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'"MIT,BSD-3-Clause,BSD-2-Clause,Apache-2.0"'})]}),"\n",(0,r.jsx)(n.h3,{id:"forbidden",children:(0,r.jsx)(n.code,{children:"forbidden"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," Deny the use of certain licenses. The expected format is a comma-separated list."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'""'})]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["The allowed and forbidden options can't be used at the same time. If you want to use ",(0,r.jsx)(n.code,{children:"forbidden"})," set ",(0,r.jsx)(n.code,{children:"allowed"})," to an empty string."]})}),"\n",(0,r.jsx)(n.h3,{id:"skip_packages",children:(0,r.jsx)(n.code,{children:"skip_packages"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," Skip packages from having their licenses checked."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'""'})]}),"\n",(0,r.jsx)(n.h3,{id:"dependency_type",children:(0,r.jsx)(n.code,{children:"dependency_type"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," The type of dependencies to check licenses for."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:'"direct-main,transitive"'})]}),"\n",(0,r.jsx)(n.h3,{id:"ignore_retrieval_failures",children:(0,r.jsx)(n.code,{children:"ignore_retrieval_failures"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," Disregard licenses that failed to be retrieved."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Default"})," ",(0,r.jsx)(n.code,{children:"false"})]}),"\n",(0,r.jsx)(n.h2,{id:"secrets",children:"Secrets"}),"\n",(0,r.jsx)(n.h3,{id:"ssh_key",children:(0,r.jsx)(n.code,{children:"ssh_key"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optional"})," An SSH key to use for setting up the credentials for fetching dependencies that are not publicly available."]}),"\n",(0,r.jsx)(n.h2,{id:"example-usage",children:"Example Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"name: license_check\n\nconcurrency:\n  group: ${{ github.workflow }}-${{ github.ref }}\n  cancel-in-progress: true\n\non:\n  pull_request:\n    paths:\n      - 'pubspec.yaml'\n      - '.github/workflows/license_check.yaml'\n  push:\n    branches:\n      - main\n    paths:\n      - 'pubspec.yaml'\n      - '.github/workflows/license_check.yaml'\n\njobs:\n  license_check:\n    uses: VeryGoodOpenSource/very_good_workflows/.github/workflows/license_check.yml@v1\n    with:\n      allowed: 'MIT,BSD-3-Clause,BSD-2-Clause,Apache-2.0'\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The example ",(0,r.jsx)(n.a,{href:"https://docs.github.com/en/actions/quickstart#creating-your-first-workflow",children:"workflow file"})," will ",(0,r.jsx)(n.a,{href:"https://docs.github.com/en/actions/using-workflows/triggering-a-workflow",children:"trigger"})," the ",(0,r.jsx)(n.code,{children:"license_check"})," job on every push to the ",(0,r.jsx)(n.code,{children:"main"})," branch and on every pull request that modifies the ",(0,r.jsx)(n.code,{children:"pubspec.yaml"})," or the ",(0,r.jsx)(n.code,{children:"license_check.yaml"})," workflow file."]}),"\n",(0,r.jsxs)(n.p,{children:["If you are ",(0,r.jsxs)(n.a,{href:"https://dart.dev/guides/libraries/private-files#pubspec-lock",children:["committing the ",(0,r.jsx)(n.code,{children:"pubspec.lock"})]})," file for an application package you may consider adding it to the list of paths to trigger the workflow."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"For repositories with multiple packages we recommend adding a workflow file per package to avoid triggering a license check for packages which dependencies haven't been modified."})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(6540);const r={},c=i.createContext(r);function o(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);